import e from"axios";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function t(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))}var r;!function(e){e.formPost="form_post",e.query="query"}(r||(r={}));const n="/oauth2/authorize",i="/oidc/checksession",o="/oidc/logout",s="/oauth2/jwks",a="/oauth2/revoke",u="/oauth2/token",c="/oauth2/token/.well-known/openid-configuration",h="{{token}}",d="{{username}}",l="{{scope}}",f="{{clientID}}",p="{{clientSecret}}";var v;!function(e){e.ConfigData="config_data",e.OIDCProviderMetaData="oidc_provider_meta_data",e.SessionData="session_data",e.TemporaryData="temporary_data"}(v||(v={}));const g="refresh_token_timer",y="pkce_code_verifier",m="code",w="session_state",_="sign_out_url",T="sign_out_success",S="openid";class b extends Error{constructor(e,t,r,n,i,o){super(null!=n?n:null==o?void 0:o.message),this.name=this.constructor.name,this.code=e,this.file=t,this.method=r,this.description=i,this.error=o,Object.setPrototypeOf(this,new.target.prototype)}}class A extends b{constructor(e,t,r,n,i,o,s,a,u){super(e,t,r,n,i),this.name=this.constructor.name,this.code=e,this.file=t,this.method=r,this.description=i,this.networkErrorCode=o,this.networkErrorMessage=s,this.status=a,this.networkErrorData=u}}var k="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function E(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function D(e,t,r){return e(r={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&r.path)}},r.exports),r.exports}function P(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})})),t}var R="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},C=[],O=[],I="undefined"!=typeof Uint8Array?Uint8Array:Array,U=!1;function L(){U=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,r=e.length;t<r;++t)C[t]=e[t],O[e.charCodeAt(t)]=t;O["-".charCodeAt(0)]=62,O["_".charCodeAt(0)]=63}function H(e,t,r){for(var n,i,o=[],s=t;s<r;s+=3)n=(e[s]<<16)+(e[s+1]<<8)+e[s+2],o.push(C[(i=n)>>18&63]+C[i>>12&63]+C[i>>6&63]+C[63&i]);return o.join("")}function M(e){var t;U||L();for(var r=e.length,n=r%3,i="",o=[],s=16383,a=0,u=r-n;a<u;a+=s)o.push(H(e,a,a+s>u?u:a+s));return 1===n?(t=e[r-1],i+=C[t>>2],i+=C[t<<4&63],i+="=="):2===n&&(t=(e[r-2]<<8)+e[r-1],i+=C[t>>10],i+=C[t>>4&63],i+=C[t<<2&63],i+="="),o.push(i),o.join("")}function j(e,t,r,n,i){var o,s,a=8*i-n-1,u=(1<<a)-1,c=u>>1,h=-7,d=r?i-1:0,l=r?-1:1,f=e[t+d];for(d+=l,o=f&(1<<-h)-1,f>>=-h,h+=a;h>0;o=256*o+e[t+d],d+=l,h-=8);for(s=o&(1<<-h)-1,o>>=-h,h+=n;h>0;s=256*s+e[t+d],d+=l,h-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,n),o-=c}return(f?-1:1)*s*Math.pow(2,o-n)}function K(e,t,r,n,i,o){var s,a,u,c=8*o-i-1,h=(1<<c)-1,d=h>>1,l=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:o-1,p=n?1:-1,v=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=h):(s=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-s))<1&&(s--,u*=2),(t+=s+d>=1?l/u:l*Math.pow(2,1-d))*u>=2&&(s++,u/=2),s+d>=h?(a=0,s=h):s+d>=1?(a=(t*u-1)*Math.pow(2,i),s+=d):(a=t*Math.pow(2,d-1)*Math.pow(2,i),s=0));i>=8;e[r+f]=255&a,f+=p,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;e[r+f]=255&s,f+=p,s/=256,c-=8);e[r+f-p]|=128*v}var x={}.toString,N=Array.isArray||function(e){return"[object Array]"==x.call(e)};q.TYPED_ARRAY_SUPPORT=void 0===R.TYPED_ARRAY_SUPPORT||R.TYPED_ARRAY_SUPPORT;var B=W();function W(){return q.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function J(e,t){if(W()<t)throw new RangeError("Invalid typed array length");return q.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=q.prototype:(null===e&&(e=new q(t)),e.length=t),e}function q(e,t,r){if(!(q.TYPED_ARRAY_SUPPORT||this instanceof q))return new q(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return F(this,e)}return Y(this,e,t,r)}function Y(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n);q.TYPED_ARRAY_SUPPORT?(e=t).__proto__=q.prototype:e=$(e,t);return e}(e,t,r,n):"string"==typeof t?function(e,t,r){"string"==typeof r&&""!==r||(r="utf8");if(!q.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|X(t,r),i=(e=J(e,n)).write(t,r);i!==n&&(e=e.slice(0,i));return e}(e,t,r):function(e,t){if(G(t)){var r=0|V(t.length);return 0===(e=J(e,r)).length||t.copy(e,0,0,r),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(n=t.length)!=n?J(e,0):$(e,t);if("Buffer"===t.type&&N(t.data))return $(e,t.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function z(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function F(e,t){if(z(t),e=J(e,t<0?0:0|V(t)),!q.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function $(e,t){var r=t.length<0?0:0|V(t.length);e=J(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function V(e){if(e>=W())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+W().toString(16)+" bytes");return 0|e}function G(e){return!(null==e||!e._isBuffer)}function X(e,t){if(G(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return be(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return Ae(e).length;default:if(n)return be(e).length;t=(""+t).toLowerCase(),n=!0}}function Z(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return le(this,t,r);case"utf8":case"utf-8":return ce(this,t,r);case"ascii":return he(this,t,r);case"latin1":case"binary":return de(this,t,r);case"base64":return ue(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return fe(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function Q(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function ee(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=q.from(t,n)),G(t))return 0===t.length?-1:te(e,t,r,n,i);if("number"==typeof t)return t&=255,q.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):te(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function te(e,t,r,n,i){var o,s=1,a=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,a/=2,u/=2,r/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var h=-1;for(o=r;o<a;o++)if(c(e,o)===c(t,-1===h?0:o-h)){if(-1===h&&(h=o),o-h+1===u)return h*s}else-1!==h&&(o-=o-h),h=-1}else for(r+u>a&&(r=a-u),o=r;o>=0;o--){for(var d=!0,l=0;l<u;l++)if(c(e,o+l)!==c(t,l)){d=!1;break}if(d)return o}return-1}function re(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var s=0;s<n;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[r+s]=a}return s}function ne(e,t,r,n){return ke(be(t,e.length-r),e,r,n)}function ie(e,t,r,n){return ke(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function oe(e,t,r,n){return ie(e,t,r,n)}function se(e,t,r,n){return ke(Ae(t),e,r,n)}function ae(e,t,r,n){return ke(function(e,t){for(var r,n,i,o=[],s=0;s<e.length&&!((t-=2)<0);++s)n=(r=e.charCodeAt(s))>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function ue(e,t,r){return 0===t&&r===e.length?M(e):M(e.slice(t,r))}function ce(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,s,a,u,c=e[i],h=null,d=c>239?4:c>223?3:c>191?2:1;if(i+d<=r)switch(d){case 1:c<128&&(h=c);break;case 2:128==(192&(o=e[i+1]))&&(u=(31&c)<<6|63&o)>127&&(h=u);break;case 3:o=e[i+1],s=e[i+2],128==(192&o)&&128==(192&s)&&(u=(15&c)<<12|(63&o)<<6|63&s)>2047&&(u<55296||u>57343)&&(h=u);break;case 4:o=e[i+1],s=e[i+2],a=e[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(u=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(h=u)}null===h?(h=65533,d=1):h>65535&&(h-=65536,n.push(h>>>10&1023|55296),h=56320|1023&h),n.push(h),i+=d}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=4096));return r}(n)}q.poolSize=8192,q._augment=function(e){return e.__proto__=q.prototype,e},q.from=function(e,t,r){return Y(null,e,t,r)},q.TYPED_ARRAY_SUPPORT&&(q.prototype.__proto__=Uint8Array.prototype,q.__proto__=Uint8Array),q.alloc=function(e,t,r){return function(e,t,r,n){return z(t),t<=0?J(e,t):void 0!==r?"string"==typeof n?J(e,t).fill(r,n):J(e,t).fill(r):J(e,t)}(null,e,t,r)},q.allocUnsafe=function(e){return F(null,e)},q.allocUnsafeSlow=function(e){return F(null,e)},q.isBuffer=Ee,q.compare=function(e,t){if(!G(e)||!G(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},q.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},q.concat=function(e,t){if(!N(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return q.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=q.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var o=e[r];if(!G(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i),i+=o.length}return n},q.byteLength=X,q.prototype._isBuffer=!0,q.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)Q(this,t,t+1);return this},q.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)Q(this,t,t+3),Q(this,t+1,t+2);return this},q.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)Q(this,t,t+7),Q(this,t+1,t+6),Q(this,t+2,t+5),Q(this,t+3,t+4);return this},q.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?ce(this,0,e):Z.apply(this,arguments)},q.prototype.equals=function(e){if(!G(e))throw new TypeError("Argument must be a Buffer");return this===e||0===q.compare(this,e)},q.prototype.inspect=function(){var e="";return this.length>0&&(e=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(e+=" ... ")),"<Buffer "+e+">"},q.prototype.compare=function(e,t,r,n,i){if(!G(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(t>>>=0),a=Math.min(o,s),u=this.slice(n,i),c=e.slice(t,r),h=0;h<a;++h)if(u[h]!==c[h]){o=u[h],s=c[h];break}return o<s?-1:s<o?1:0},q.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},q.prototype.indexOf=function(e,t,r){return ee(this,e,t,r,!0)},q.prototype.lastIndexOf=function(e,t,r){return ee(this,e,t,r,!1)},q.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return re(this,e,t,r);case"utf8":case"utf-8":return ne(this,e,t,r);case"ascii":return ie(this,e,t,r);case"latin1":case"binary":return oe(this,e,t,r);case"base64":return se(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ae(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},q.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function he(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function de(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function le(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=Se(e[o]);return i}function fe(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function pe(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function ve(e,t,r,n,i,o){if(!G(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function ge(e,t,r,n){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-r,2);i<o;++i)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function ye(e,t,r,n){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-r,4);i<o;++i)e[r+i]=t>>>8*(n?i:3-i)&255}function me(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function we(e,t,r,n,i){return i||me(e,0,r,4),K(e,t,r,n,23,4),r+4}function _e(e,t,r,n,i){return i||me(e,0,r,8),K(e,t,r,n,52,8),r+8}q.prototype.slice=function(e,t){var r,n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),q.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=q.prototype;else{var i=t-e;r=new q(i,void 0);for(var o=0;o<i;++o)r[o]=this[o+e]}return r},q.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||pe(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},q.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||pe(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},q.prototype.readUInt8=function(e,t){return t||pe(e,1,this.length),this[e]},q.prototype.readUInt16LE=function(e,t){return t||pe(e,2,this.length),this[e]|this[e+1]<<8},q.prototype.readUInt16BE=function(e,t){return t||pe(e,2,this.length),this[e]<<8|this[e+1]},q.prototype.readUInt32LE=function(e,t){return t||pe(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},q.prototype.readUInt32BE=function(e,t){return t||pe(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},q.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||pe(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},q.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||pe(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},q.prototype.readInt8=function(e,t){return t||pe(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},q.prototype.readInt16LE=function(e,t){t||pe(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},q.prototype.readInt16BE=function(e,t){t||pe(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},q.prototype.readInt32LE=function(e,t){return t||pe(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},q.prototype.readInt32BE=function(e,t){return t||pe(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},q.prototype.readFloatLE=function(e,t){return t||pe(e,4,this.length),j(this,e,!0,23,4)},q.prototype.readFloatBE=function(e,t){return t||pe(e,4,this.length),j(this,e,!1,23,4)},q.prototype.readDoubleLE=function(e,t){return t||pe(e,8,this.length),j(this,e,!0,52,8)},q.prototype.readDoubleBE=function(e,t){return t||pe(e,8,this.length),j(this,e,!1,52,8)},q.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||ve(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},q.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||ve(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},q.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||ve(this,e,t,1,255,0),q.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},q.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||ve(this,e,t,2,65535,0),q.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):ge(this,e,t,!0),t+2},q.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||ve(this,e,t,2,65535,0),q.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):ge(this,e,t,!1),t+2},q.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||ve(this,e,t,4,4294967295,0),q.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):ye(this,e,t,!0),t+4},q.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||ve(this,e,t,4,4294967295,0),q.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):ye(this,e,t,!1),t+4},q.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);ve(this,e,t,r,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<r&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},q.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);ve(this,e,t,r,i-1,-i)}var o=r-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},q.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||ve(this,e,t,1,127,-128),q.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},q.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||ve(this,e,t,2,32767,-32768),q.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):ge(this,e,t,!0),t+2},q.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||ve(this,e,t,2,32767,-32768),q.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):ge(this,e,t,!1),t+2},q.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||ve(this,e,t,4,2147483647,-2147483648),q.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):ye(this,e,t,!0),t+4},q.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||ve(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),q.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):ye(this,e,t,!1),t+4},q.prototype.writeFloatLE=function(e,t,r){return we(this,e,t,!0,r)},q.prototype.writeFloatBE=function(e,t,r){return we(this,e,t,!1,r)},q.prototype.writeDoubleLE=function(e,t,r){return _e(this,e,t,!0,r)},q.prototype.writeDoubleBE=function(e,t,r){return _e(this,e,t,!1,r)},q.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i,o=n-r;if(this===e&&r<t&&t<n)for(i=o-1;i>=0;--i)e[i+t]=this[i+r];else if(o<1e3||!q.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+o),t);return o},q.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!q.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(o=t;o<r;++o)this[o]=e;else{var s=G(e)?e:be(new q(e,n).toString()),a=s.length;for(o=0;o<r-t;++o)this[o+t]=s[o%a]}return this};var Te=/[^+\/0-9A-Za-z-_]/g;function Se(e){return e<16?"0"+e.toString(16):e.toString(16)}function be(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],s=0;s<n;++s){if((r=e.charCodeAt(s))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function Ae(e){return function(e){var t,r,n,i,o,s;U||L();var a=e.length;if(a%4>0)throw new Error("Invalid string. Length must be a multiple of 4");o="="===e[a-2]?2:"="===e[a-1]?1:0,s=new I(3*a/4-o),n=o>0?a-4:a;var u=0;for(t=0,r=0;t<n;t+=4,r+=3)i=O[e.charCodeAt(t)]<<18|O[e.charCodeAt(t+1)]<<12|O[e.charCodeAt(t+2)]<<6|O[e.charCodeAt(t+3)],s[u++]=i>>16&255,s[u++]=i>>8&255,s[u++]=255&i;return 2===o?(i=O[e.charCodeAt(t)]<<2|O[e.charCodeAt(t+1)]>>4,s[u++]=255&i):1===o&&(i=O[e.charCodeAt(t)]<<10|O[e.charCodeAt(t+1)]<<4|O[e.charCodeAt(t+2)]>>2,s[u++]=i>>8&255,s[u++]=255&i),s}(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(Te,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function ke(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function Ee(e){return null!=e&&(!!e._isBuffer||De(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&De(e.slice(0,0))}(e))}function De(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}var Pe=Object.freeze({__proto__:null,Buffer:q,INSPECT_MAX_BYTES:50,SlowBuffer:function(e){return+e!=e&&(e=0),q.alloc(+e)},isBuffer:Ee,kMaxLength:B}),Re=D((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.length,r=t%4;if(!r)return e;var n=t,i=4-r,o=t+i,s=q.alloc(o);for(s.write(e);i--;)s.write("=",n++);return s.toString()}})),Ce=D((function(e,t){function r(e,t){return void 0===t&&(t="utf8"),q.isBuffer(e)?i(e.toString("base64")):i(q.from(e,t).toString("base64"))}function n(e){return e=e.toString(),Re.default(e).replace(/\-/g,"+").replace(/_/g,"/")}function i(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}Object.defineProperty(t,"__esModule",{value:!0});var o=r;o.encode=r,o.decode=function(e,t){return void 0===t&&(t="utf8"),q.from(n(e),"base64").toString(t)},o.toBase64=n,o.fromBase64=i,o.toBuffer=function(e){return q.from(n(e),"base64")},t.default=o})),Oe=D((function(e){e.exports=Ce.default,e.exports.default=e.exports})),Ie=E(D((function(e){!function(t,r){var n={};!function(e){e.__esModule=!0,e.digestLength=32,e.blockSize=64;var t=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function r(e,r,n,i,o){for(var s,a,u,c,h,d,l,f,p,v,g,y,m;o>=64;){for(s=r[0],a=r[1],u=r[2],c=r[3],h=r[4],d=r[5],l=r[6],f=r[7],v=0;v<16;v++)g=i+4*v,e[v]=(255&n[g])<<24|(255&n[g+1])<<16|(255&n[g+2])<<8|255&n[g+3];for(v=16;v<64;v++)y=((p=e[v-2])>>>17|p<<15)^(p>>>19|p<<13)^p>>>10,m=((p=e[v-15])>>>7|p<<25)^(p>>>18|p<<14)^p>>>3,e[v]=(y+e[v-7]|0)+(m+e[v-16]|0);for(v=0;v<64;v++)y=(((h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7))+(h&d^~h&l)|0)+(f+(t[v]+e[v]|0)|0)|0,m=((s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10))+(s&a^s&u^a&u)|0,f=l,l=d,d=h,h=c+y|0,c=u,u=a,a=s,s=y+m|0;r[0]+=s,r[1]+=a,r[2]+=u,r[3]+=c,r[4]+=h,r[5]+=d,r[6]+=l,r[7]+=f,i+=64,o-=64}return i}var n=function(){function t(){this.digestLength=e.digestLength,this.blockSize=e.blockSize,this.state=new Int32Array(8),this.temp=new Int32Array(64),this.buffer=new Uint8Array(128),this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this.reset()}return t.prototype.reset=function(){return this.state[0]=1779033703,this.state[1]=3144134277,this.state[2]=1013904242,this.state[3]=2773480762,this.state[4]=1359893119,this.state[5]=2600822924,this.state[6]=528734635,this.state[7]=1541459225,this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this},t.prototype.clean=function(){for(var e=0;e<this.buffer.length;e++)this.buffer[e]=0;for(e=0;e<this.temp.length;e++)this.temp[e]=0;this.reset()},t.prototype.update=function(e,t){if(void 0===t&&(t=e.length),this.finished)throw new Error("SHA256: can't update because hash was finished.");var n=0;if(this.bytesHashed+=t,this.bufferLength>0){for(;this.bufferLength<64&&t>0;)this.buffer[this.bufferLength++]=e[n++],t--;64===this.bufferLength&&(r(this.temp,this.state,this.buffer,0,64),this.bufferLength=0)}for(t>=64&&(n=r(this.temp,this.state,e,n,t),t%=64);t>0;)this.buffer[this.bufferLength++]=e[n++],t--;return this},t.prototype.finish=function(e){if(!this.finished){var t=this.bytesHashed,n=this.bufferLength,i=t/536870912|0,o=t<<3,s=t%64<56?64:128;this.buffer[n]=128;for(var a=n+1;a<s-8;a++)this.buffer[a]=0;this.buffer[s-8]=i>>>24&255,this.buffer[s-7]=i>>>16&255,this.buffer[s-6]=i>>>8&255,this.buffer[s-5]=i>>>0&255,this.buffer[s-4]=o>>>24&255,this.buffer[s-3]=o>>>16&255,this.buffer[s-2]=o>>>8&255,this.buffer[s-1]=o>>>0&255,r(this.temp,this.state,this.buffer,0,s),this.finished=!0}for(a=0;a<8;a++)e[4*a+0]=this.state[a]>>>24&255,e[4*a+1]=this.state[a]>>>16&255,e[4*a+2]=this.state[a]>>>8&255,e[4*a+3]=this.state[a]>>>0&255;return this},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype._saveState=function(e){for(var t=0;t<this.state.length;t++)e[t]=this.state[t]},t.prototype._restoreState=function(e,t){for(var r=0;r<this.state.length;r++)this.state[r]=e[r];this.bytesHashed=t,this.finished=!1,this.bufferLength=0},t}();e.Hash=n;var i=function(){function e(e){this.inner=new n,this.outer=new n,this.blockSize=this.inner.blockSize,this.digestLength=this.inner.digestLength;var t=new Uint8Array(this.blockSize);if(e.length>this.blockSize)(new n).update(e).finish(t).clean();else for(var r=0;r<e.length;r++)t[r]=e[r];for(r=0;r<t.length;r++)t[r]^=54;this.inner.update(t);for(r=0;r<t.length;r++)t[r]^=106;this.outer.update(t),this.istate=new Uint32Array(8),this.ostate=new Uint32Array(8),this.inner._saveState(this.istate),this.outer._saveState(this.ostate);for(r=0;r<t.length;r++)t[r]=0}return e.prototype.reset=function(){return this.inner._restoreState(this.istate,this.inner.blockSize),this.outer._restoreState(this.ostate,this.outer.blockSize),this},e.prototype.clean=function(){for(var e=0;e<this.istate.length;e++)this.ostate[e]=this.istate[e]=0;this.inner.clean(),this.outer.clean()},e.prototype.update=function(e){return this.inner.update(e),this},e.prototype.finish=function(e){return this.outer.finished?this.outer.finish(e):(this.inner.finish(e),this.outer.update(e,this.digestLength).finish(e)),this},e.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},e}();function o(e){var t=(new n).update(e),r=t.digest();return t.clean(),r}function s(e,t){var r=new i(e).update(t),n=r.digest();return r.clean(),n}function a(e,t,r,n){var i=n[0];if(0===i)throw new Error("hkdf: cannot expand more");t.reset(),i>1&&t.update(e),r&&t.update(r),t.update(n),t.finish(e),n[0]++}e.HMAC=i,e.hash=o,e.default=o,e.hmac=s;var u=new Uint8Array(e.digestLength);function c(e,t,r,n){void 0===t&&(t=u),void 0===n&&(n=32);for(var o=new Uint8Array([1]),c=s(t,e),h=new i(c),d=new Uint8Array(h.digestLength),l=d.length,f=new Uint8Array(n),p=0;p<n;p++)l===d.length&&(a(d,h,r,o),l=0),f[p]=d[l++];return h.clean(),d.fill(0),o.fill(0),f}function h(e,t,r,n){for(var o=new i(e),s=o.digestLength,a=new Uint8Array(4),u=new Uint8Array(s),c=new Uint8Array(s),h=new Uint8Array(n),d=0;d*s<n;d++){var l=d+1;a[0]=l>>>24&255,a[1]=l>>>16&255,a[2]=l>>>8&255,a[3]=l>>>0&255,o.reset(),o.update(t),o.update(a),o.finish(c);for(var f=0;f<s;f++)u[f]=c[f];for(f=2;f<=r;f++){o.reset(),o.update(c).finish(c);for(var p=0;p<s;p++)u[p]^=c[p]}for(f=0;f<s&&d*s+f<n;f++)h[d*s+f]=u[f]}for(d=0;d<s;d++)u[d]=c[d]=0;for(d=0;d<4;d++)a[d]=0;return o.clean(),h}e.hkdf=c,e.pbkdf2=h}(n);var i=n.default;for(var o in n)i[o]=n[o];e.exports=i}()})));function Ue(){throw new Error("setTimeout has not been defined")}function Le(){throw new Error("clearTimeout has not been defined")}var He=Ue,Me=Le;function je(e){if(He===setTimeout)return setTimeout(e,0);if((He===Ue||!He)&&setTimeout)return He=setTimeout,setTimeout(e,0);try{return He(e,0)}catch(t){try{return He.call(null,e,0)}catch(t){return He.call(this,e,0)}}}"function"==typeof R.setTimeout&&(He=setTimeout),"function"==typeof R.clearTimeout&&(Me=clearTimeout);var Ke,xe=[],Ne=!1,Be=-1;function We(){Ne&&Ke&&(Ne=!1,Ke.length?xe=Ke.concat(xe):Be=-1,xe.length&&Je())}function Je(){if(!Ne){var e=je(We);Ne=!0;for(var t=xe.length;t;){for(Ke=xe,xe=[];++Be<t;)Ke&&Ke[Be].run();Be=-1,t=xe.length}Ke=null,Ne=!1,function(e){if(Me===clearTimeout)return clearTimeout(e);if((Me===Le||!Me)&&clearTimeout)return Me=clearTimeout,clearTimeout(e);try{Me(e)}catch(t){try{return Me.call(null,e)}catch(t){return Me.call(this,e)}}}(e)}}function qe(e,t){this.fun=e,this.array=t}qe.prototype.run=function(){this.fun.apply(null,this.array)};function Ye(){}var ze=Ye,Fe=Ye,$e=Ye,Ve=Ye,Ge=Ye,Xe=Ye,Ze=Ye;var Qe=R.performance||{},et=Qe.now||Qe.mozNow||Qe.msNow||Qe.oNow||Qe.webkitNow||function(){return(new Date).getTime()};var tt=new Date;var rt={nextTick:function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];xe.push(new qe(e,t)),1!==xe.length||Ne||je(Je)},title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:ze,addListener:Fe,once:$e,off:Ve,removeListener:Ge,removeAllListeners:Xe,emit:Ze,binding:function(e){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(e){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(e){var t=.001*et.call(Qe),r=Math.floor(t),n=Math.floor(t%1*1e9);return e&&(r-=e[0],(n-=e[1])<0&&(r--,n+=1e9)),[r,n]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-tt)/1e3}},nt=P(Pe),it=D((function(e,t){var r=nt.Buffer;function n(e,t){for(var r in e)t[r]=e[r]}function i(e,t,n){return r(e,t,n)}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=nt:(n(nt,t),t.Buffer=i),n(r,i),i.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return r(e,t,n)},i.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=r(e);return void 0!==t?"string"==typeof n?i.fill(t,n):i.fill(t):i.fill(0),i},i.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r(e)},i.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return nt.SlowBuffer(e)}})),ot=D((function(e){var t=65536,r=4294967295;var n=it.Buffer,i=k.crypto||k.msCrypto;i&&i.getRandomValues?e.exports=function(e,o){if(e>r)throw new RangeError("requested too many random bytes");var s=n.allocUnsafe(e);if(e>0)if(e>t)for(var a=0;a<e;a+=t)i.getRandomValues(s.slice(a,a+t));else i.getRandomValues(s);if("function"==typeof o)return rt.nextTick((function(){o(null,s)}));return s}:e.exports=function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}}));const st=new TextEncoder,at=new TextDecoder;var ut=function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;throw new Error("unable to locate global object")}();const ct=e=>{let t=e;return t instanceof Uint8Array&&(t=at.decode(t)),t=t.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,""),new Uint8Array(ut.atob(t).split("").map((e=>e.charCodeAt(0))))};class ht extends Error{constructor(e){super(e),this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}class dt extends ht{constructor(e,t="unspecified",r="unspecified"){super(e),this.code="ERR_JWT_CLAIM_VALIDATION_FAILED",this.claim=t,this.reason=r}}class lt extends ht{constructor(){super(...arguments),this.code="ERR_JOSE_ALG_NOT_ALLOWED"}}class ft extends ht{constructor(){super(...arguments),this.code="ERR_JOSE_NOT_SUPPORTED"}}class pt extends ht{constructor(){super(...arguments),this.code="ERR_JWS_INVALID"}}class vt extends ht{constructor(){super(...arguments),this.code="ERR_JWT_INVALID"}}class gt extends ht{constructor(){super(...arguments),this.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED",this.message="signature verification failed"}}class yt extends dt{constructor(){super(...arguments),this.code="ERR_JWT_EXPIRED"}}var mt=ut.crypto;function wt(){if(!ut.isSecureContext&&!ut.crypto.subtle)throw new ht("Web Cryptography API is available only in Secure Contexts. See: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts")}const _t=async e=>{var t,r;const{algorithm:n,keyUsages:i}=function(e){let t,r;switch(e.kty){case"oct":switch(e.alg){case"HS256":case"HS384":case"HS512":t={name:"HMAC",hash:`SHA-${e.alg.substr(-3)}`},r=["sign","verify"];break;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":throw new ft(`${e.alg} keys cannot be imported as CryptoKey instances`);case"A128GCM":case"A192GCM":case"A256GCM":case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":t={name:"AES-GCM"},r=["encrypt","decrypt"];break;case"A128KW":case"A192KW":case"A256KW":t={name:"AES-KW"},r=["wrapKey","unwrapKey"];break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":t={name:"PBKDF2"},r=["deriveBits"];break;default:throw new ft('unsupported or invalid JWK "alg" (Algorithm) Parameter value')}break;case"RSA":switch(e.alg){case"PS256":case"PS384":case"PS512":t={name:"RSA-PSS",hash:`SHA-${e.alg.substr(-3)}`},r=e.d?["sign"]:["verify"];break;case"RS256":case"RS384":case"RS512":t={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${e.alg.substr(-3)}`},r=e.d?["sign"]:["verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":t={name:"RSA-OAEP",hash:`SHA-${parseInt(e.alg.substr(-3),10)||1}`},r=e.d?["decrypt","unwrapKey"]:["encrypt","wrapKey"];break;default:throw new ft('unsupported or invalid JWK "alg" (Algorithm) Parameter value')}break;case"EC":switch(e.alg){case"ES256":case"ES384":case"ES512":t={name:"ECDSA",namedCurve:e.crv},r=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:"ECDH",namedCurve:e.crv},r=e.d?["deriveBits"]:[];break;default:throw new ft('unsupported or invalid JWK "alg" (Algorithm) Parameter value')}break;default:throw new ft('unsupported or invalid JWK "kty" (Key Type) Parameter value')}return{algorithm:t,keyUsages:r}}(e);let o="jwk",s={...e};return delete s.alg,"PBKDF2"===n.name&&(o="raw",s=ct(e.k)),wt(),mt.subtle.importKey(o,s,n,null!==(t=e.ext)&&void 0!==t&&t,null!==(r=e.key_ops)&&void 0!==r?r:i)};function Tt(e){return!!e&&e.constructor===Object}async function St(e,t,r){if(!Tt(e))throw new TypeError("JWK must be an object");if(t||(t=e.alg),"string"!=typeof t||!t)throw new TypeError('"alg" argument is required when "jwk.alg" is not present');switch(e.kty){case"oct":if("string"!=typeof e.k||!e.k)throw new TypeError('missing "k" (Key Value) Parameter value');return null!=r||(r=!0!==e.ext),r?_t({...e,alg:t,ext:!1}):ct(e.k);case"RSA":if(void 0!==e.oth)throw new ft('RSA JWK "oth" (Other Primes Info) Parameter value is unsupported');case"EC":case"OKP":return _t({...e,alg:t});default:throw new ft('unsupported "kty" (Key Type) Parameter value')}}const bt=async(e,t,r,n)=>{let i;if(wt(),t instanceof Uint8Array){if(!e.startsWith("HS"))throw new TypeError("symmetric keys are only applicable for HMAC-based algorithms");i=await mt.subtle.importKey("raw",t,{hash:`SHA-${e.substr(-3)}`,name:"HMAC"},!1,["verify"])}else i=t;return((e,t)=>{if(e.startsWith("HS")){const r=parseInt(e.substr(-3),10),{length:n}=t.algorithm;if("number"!=typeof n||n<r)throw new TypeError(`${e} requires symmetric keys to be ${r} bits or larger`)}if(e.startsWith("RS")||e.startsWith("PS")){const{modulusLength:r}=t.algorithm;if("number"!=typeof r||r<2048)throw new TypeError(`${e} requires key modulusLength to be 2048 bits or larger`)}})(e,i),mt.subtle.verify(function(e){switch(e){case"HS256":return{hash:"SHA-256",name:"HMAC"};case"HS384":return{hash:"SHA-384",name:"HMAC"};case"HS512":return{hash:"SHA-512",name:"HMAC"};case"PS256":return{hash:"SHA-256",name:"RSA-PSS",saltLength:32};case"PS384":return{hash:"SHA-384",name:"RSA-PSS",saltLength:48};case"PS512":return{hash:"SHA-512",name:"RSA-PSS",saltLength:64};case"RS256":return{hash:"SHA-256",name:"RSASSA-PKCS1-v1_5"};case"RS384":return{hash:"SHA-384",name:"RSASSA-PKCS1-v1_5"};case"RS512":return{hash:"SHA-512",name:"RSASSA-PKCS1-v1_5"};case"ES256":return{hash:"SHA-256",name:"ECDSA",namedCurve:"P-256"};case"ES384":return{hash:"SHA-384",name:"ECDSA",namedCurve:"P-384"};case"ES512":return{hash:"SHA-512",name:"ECDSA",namedCurve:"P-521"};default:throw new ft(`alg ${e} is unsupported either by JOSE or your javascript runtime`)}}(e),i,r,n)};const At=function(e,t,r,n){if(void 0!==n.crit&&void 0===r.crit)throw new e('"crit" (Critical) Header Parameter MUST be integrity protected');if(!r||void 0===r.crit)return new Set;if(!Array.isArray(r.crit)||0===r.crit.length||r.crit.some((e=>"string"!=typeof e||0===e.length)))throw new e('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');for(const i of r.crit){if(!t.has(i))throw new ft(`Extension Header Parameter "${i}" is not supported by this implementation`);if(void 0===n[i])throw new e(`Extension Header Parameter "${i}" is missing`);if(t.get(i)&&void 0===r[i])throw new e(`Extension Header Parameter "${i}" MUST be integrity protected`)}return new Set(r.crit)}.bind(void 0,pt,new Map([["b64",!0]])),kt=((e,t)=>{if(void 0!==t&&(!Array.isArray(t)||t.some((e=>"string"!=typeof e))))throw new TypeError(`"${e}" option must be an array of strings`);if(t)return new Set(t)}).bind(void 0,"algorithms");async function Et(e,t,r){if(!Tt(e))throw new pt("Flattened JWS must be an object");if(void 0===e.protected&&void 0===e.header)throw new pt('Flattened JWS must have either of the "protected" or "header" members');if(void 0!==e.protected&&"string"!=typeof e.protected)throw new pt("JWS Protected Header incorrect type");if(void 0===e.payload)throw new pt("JWS Payload missing");if("string"!=typeof e.signature)throw new pt("JWS Signature missing or incorrect type");if(void 0!==e.header&&!Tt(e.header))throw new pt("JWS Unprotected Header incorrect type");let n={};if(e.protected){const t=ct(e.protected);n=JSON.parse(at.decode(t))}if(!((...e)=>{const t=e.filter(Boolean);if(0===t.length||1===t.length)return!0;let r;for(const e of t){const t=Object.keys(e);if(r&&0!==r.size)for(const e of t){if(r.has(e))return!1;r.add(e)}else r=new Set(t)}return!0})(n,e.header))throw new pt("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");const i={...n,...e.header};let o=!0;if(At(n,i).has("b64")&&(o=n.b64,"boolean"!=typeof o))throw new pt('The "b64" (base64url-encode payload) Header Parameter must be a boolean');const{alg:s}=i;if("string"!=typeof s||!s)throw new pt('JWS "alg" (Algorithm) Header Parameter missing or invalid');const a=r&&kt(r.algorithms);if(a&&!a.has(s))throw new lt('"alg" (Algorithm) Header Parameter not allowed');if(o){if("string"!=typeof e.payload)throw new pt("JWS Payload must be a string")}else if("string"!=typeof e.payload&&!(e.payload instanceof Uint8Array))throw new pt("JWS Payload must be a string or an Uint8Array instance");"function"==typeof t&&(t=await t(n,e)),((e,t)=>{if(e.startsWith("HS")||"dir"===e||e.startsWith("PBES2")||e.match(/^A\d{3}(?:GCM)KW$/)){if(t instanceof Uint8Array||"secret"===t.type)return;throw new TypeError('CryptoKey or KeyObject instances for symmetric algorithms must be of type "secret"')}if(t instanceof Uint8Array)throw new TypeError("CryptoKey or KeyObject instances must be used for asymmetric algorithms");if("secret"===t.type)throw new TypeError('CryptoKey or KeyObject instances for asymmetric algorithms must not be of type "secret"')})(s,t);const u=function(...e){const t=e.reduce(((e,{length:t})=>e+t),0),r=new Uint8Array(t);let n=0;return e.forEach((e=>{r.set(e,n),n+=e.length})),r}(st.encode(e.protected||""),st.encode("."),"string"==typeof e.payload?st.encode(e.payload):e.payload),c=ct(e.signature);if(!await bt(s,t,c,u))throw new gt;let h;h=o?ct(e.payload):"string"==typeof e.payload?st.encode(e.payload):e.payload;const d={payload:h};return void 0!==e.protected&&(d.protectedHeader=n),void 0!==e.header&&(d.unprotectedHeader=e.header),d}const Dt=/^(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)$/i;var Pt=e=>{const t=Dt.exec(e);if(!t)throw new TypeError("invalid time period format");const r=parseFloat(t[1]);switch(t[2].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":return Math.round(r);case"minute":case"minutes":case"min":case"mins":case"m":return Math.round(60*r);case"hour":case"hours":case"hr":case"hrs":case"h":return Math.round(3600*r);case"day":case"days":case"d":return Math.round(86400*r);case"week":case"weeks":case"w":return Math.round(604800*r);default:return Math.round(31557600*r)}};const Rt=e=>e.toLowerCase().replace(/^application\//,"");var Ct=(e,t,r={})=>{const{typ:n}=r;if(n&&("string"!=typeof e.typ||Rt(e.typ)!==Rt(n)))throw new dt('unexpected "typ" JWT header value',"typ","check_failed");let i;try{i=JSON.parse(at.decode(t))}catch(e){}if("object"!=typeof i||!i||Array.isArray(i))throw new vt("JWT Claims Set must be a top-level JSON object");const{issuer:o}=r;if(o&&!("string"==typeof o?[o]:o).includes(i.iss))throw new dt('unexpected "iss" claim value',"iss","check_failed");const{subject:s}=r;if(s&&i.sub!==s)throw new dt('unexpected "sub" claim value',"sub","check_failed");const{audience:a}=r;if(a&&(u=i.aud,c="string"==typeof a?[a]:a,!("string"==typeof u?c.includes(u):c.some(Set.prototype.has.bind(new Set(u))))))throw new dt('unexpected "aud" claim value',"aud","check_failed");var u,c;let h;switch(typeof r.clockTolerance){case"string":h=Pt(r.clockTolerance);break;case"number":h=r.clockTolerance;break;case"undefined":h=0;break;default:throw new TypeError("invalid clockTolerance option type")}const{currentDate:d}=r,l=(f=d||new Date,Math.floor(f.getTime()/1e3));var f;if(void 0!==i.iat||r.maxTokenAge){if("number"!=typeof i.iat)throw new dt('"iat" claim must be a number',"iat","invalid");if(void 0===i.exp&&i.iat>l+h)throw new dt('"iat" claim timestamp check failed (it should be in the past)',"iat","check_failed")}if(void 0!==i.nbf){if("number"!=typeof i.nbf)throw new dt('"nbf" claim must be a number',"nbf","invalid");if(i.nbf>l+h)throw new dt('"nbf" claim timestamp check failed',"nbf","check_failed")}if(void 0!==i.exp){if("number"!=typeof i.exp)throw new dt('"exp" claim must be a number',"exp","invalid");if(i.exp<=l-h)throw new yt('"exp" claim timestamp check failed',"exp","check_failed")}if(r.maxTokenAge){const e=l-i.iat;if(e-h>("number"==typeof r.maxTokenAge?r.maxTokenAge:Pt(r.maxTokenAge)))throw new yt('"iat" claim timestamp check failed (too far in the past)',"iat","check_failed");if(e<0-h)throw new dt('"iat" claim timestamp check failed (it should be in the past)',"iat","check_failed")}return i};async function Ot(e,t,r){const n=await async function(e,t,r){if(e instanceof Uint8Array&&(e=at.decode(e)),"string"!=typeof e)throw new pt("Compact JWS must be a string or Uint8Array");const{0:n,1:i,2:o,length:s}=e.split(".");if(3!==s)throw new pt("Invalid Compact JWS");const a=await Et({payload:i||void 0,protected:n||void 0,signature:o||void 0},t,r);return{payload:a.payload,protectedHeader:a.protectedHeader}}(e,t,r);return{payload:Ct(n.protectedHeader,n.payload,r),protectedHeader:n.protectedHeader}}class It{constructor(){}static base64URLEncode(e){return Oe.encode(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}static getCodeVerifier(){return this.base64URLEncode(ot(32))}static getCodeChallenge(e){return this.base64URLEncode(new Buffer(Ie((new TextEncoder).encode(e))))}static getSupportedSignatureAlgorithms(){return["RS256","RS512","RS384","PS256"]}static getJWKForTheIdToken(e,t){const r=JSON.parse(Oe.decode(e,"utf8"));for(const e of t)if(r.kid===e.kid)return St({alg:e.alg,e:e.e,kty:e.kty,n:e.n});return Promise.reject(new b("CRYPTO_UTIL-GTFTIT-IV01","crypto-utils","getJWKForTheIdToken","kid not found.","Failed to find the 'kid' specified in the id_token. 'kid' found in the header : "+r.kid+", Expected values: "+t.map((e=>e.kid)).join(", ")))}static isValidIdToken(e,t,r,n,i,o){return Ot(e,t,{algorithms:this.getSupportedSignatureAlgorithms(),audience:r,clockTolerance:o,issuer:n,subject:i}).then((()=>Promise.resolve(!0))).catch((e=>Promise.reject(new b("CRYPTO_UTIL-IVIT-IV02","crypto-utils","isValidIdToken","Validating ID token failed",e))))}static decodeIDToken(e){try{const t=Oe.decode(e.split(".")[1],"utf8");return JSON.parse(t)}catch(e){throw new b("CRYPTO_UTIL-DIT-IV01","crypto-utils","decodeIDToken","Decoding ID token failed.",e)}}}class Ut{constructor(){}static getAuthenticatedUserInfo(e){var t,r,n;const i=It.decodeIDToken(e),o=this.getTenantDomainFromIdTokenPayload(i),s=this.extractUserName(i),a=null!==(t=i.given_name)&&void 0!==t?t:"",u=null!==(r=i.family_name)&&void 0!==r?r:"",c=a&&u?`${a} ${u}`:a||(u||""),h=null!==(n=i.preferred_username)&&void 0!==n?n:c;return Object.assign({displayName:h,tenantDomain:o,username:s},this.filterClaimsFromIDTokenPayload(i))}static filterClaimsFromIDTokenPayload(e){const t=Object.assign({},e);null==t||delete t.iss,null==t||delete t.sub,null==t||delete t.aud,null==t||delete t.exp,null==t||delete t.iat,null==t||delete t.acr,null==t||delete t.amr,null==t||delete t.azp,null==t||delete t.auth_time,null==t||delete t.nonce,null==t||delete t.c_hash,null==t||delete t.at_hash,null==t||delete t.nbf,null==t||delete t.isk,null==t||delete t.sid;const r={};return Object.entries(t).forEach((([e,t])=>{const n=e.split("_").map(((e,t)=>0===t?e:[e[0].toUpperCase(),...e.slice(1)].join(""))).join("");r[n]=t})),r}static getTokenRequestHeaders(){return{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"}}}Ut.extractUserName=(e,t="@")=>{const r=e.sub.split(t);return r.length>2&&r.pop(),r.join(t)},Ut.getTenantDomainFromIdTokenPayload=(e,t="@")=>{const r=e.sub.split(t);return r.length>2?r[r.length-1]:""};class Lt{constructor(e){this._dataLayer=e,this._config=()=>t(this,void 0,void 0,(function*(){return yield this._dataLayer.getConfigData()})),this._oidcProviderMetaData=()=>t(this,void 0,void 0,(function*(){return yield this._dataLayer.getOIDCProviderMetaData()}))}resolveWellKnownEndpoint(){return t(this,void 0,void 0,(function*(){const e=yield this._config();return e.wellKnownEndpoint?e.serverOrigin+e.wellKnownEndpoint:e.serverOrigin+c}))}resolveEndpoints(e){return t(this,void 0,void 0,(function*(){const t={},r=yield this._config();return r.overrideWellEndpointConfig&&r.endpoints&&Object.keys(r.endpoints).forEach((e=>{const n=e.replace(/[A-Z]/g,(e=>`_${e.toLowerCase()}`));t[n]=(null==r?void 0:r.endpoints)?r.endpoints[e]:""})),Object.assign(Object.assign({},e),t)}))}resolveFallbackEndpoints(){return t(this,void 0,void 0,(function*(){const e={},t=yield this._config();(null==t?void 0:t.endpoints)&&Object.keys(t.endpoints).forEach((r=>{const n=r.split("_").map(((e,t)=>0!==t?e[0].toUpperCase()+e.substring(1):e)).join("");e[n]=(null==t?void 0:t.endpoints)?t.endpoints[n]:""}));const r={authorization_endpoint:t.serverOrigin+n,end_session_endpoint:t.serverOrigin+o,jwks_uri:t.serverOrigin+s,check_session_iframe:t.serverOrigin+i,revocation_endpoint:t.serverOrigin+a,token_endpoint:t.serverOrigin+u};return Object.assign(Object.assign({},r),e)}))}validateIdToken(r){return t(this,void 0,void 0,(function*(){const n=(yield this._dataLayer.getOIDCProviderMetaData()).jwks_uri;return n&&0!==n.trim().length?e.get(n).then((e=>t(this,void 0,void 0,(function*(){if(200!==e.status)return Promise.reject(new b("AUTH_HELPER-VIT-NR02","authentication-helper","validateIdToken","Invalid response status received for jwks request.","The request sent to get the jwks returned "+e.status+" , which is invalid."));const n=(yield this._oidcProviderMetaData()).issuer,i=(yield this.resolveWellKnownEndpoint()).split("/.well-known")[0];return n&&n===i?It.getJWKForTheIdToken(r.split(".")[0],e.data.keys).then((e=>t(this,void 0,void 0,(function*(){return It.isValidIdToken(r,e,(yield this._config()).clientID,n,Ut.getAuthenticatedUserInfo(r).username,(yield this._config()).clockTolerance).then((e=>e)).catch((e=>Promise.reject(new b("AUTH_HELPER-VIT-ES03","authentication-helper","validateIdToken",void 0,void 0,e))))})))).catch((e=>Promise.reject(new b("AUTH_HELPER-VIT-ES04","authentication-helper","validateIdToken",void 0,void 0,e)))):Promise.resolve(!1)})))).catch((e=>{var t,r,n;return Promise.reject(new A("AUTH_HELPER-VIT-NR05","authentication-helper","validateIdToken","Request to jwks endpoint failed.","The request sent to get the jwks from the server failed.",null!==(t=null==e?void 0:e.code)&&void 0!==t?t:"",null==e?void 0:e.message,null===(r=null==e?void 0:e.response)||void 0===r?void 0:r.status,null===(n=null==e?void 0:e.response)||void 0===n?void 0:n.data))})):Promise.reject(new b("AUTH_HELPER-VIT-NF01","authentication-helper","validateIdToken","JWKS endpoint not found.","No JWKS endpoint was found in the OIDC provider meta data returned by the well-known endpoint or the JWKS endpoint passed to the SDK is empty."))}))}replaceCustomGrantTemplateTags(e){var r;return t(this,void 0,void 0,(function*(){let t="openid";const n=yield this._config(),i=yield this._dataLayer.getSessionData();return n.scope&&n.scope.length>0&&(n.scope.includes("openid")||n.scope.push("openid"),t=n.scope.join(" ")),e.replace("{{token}}",i.access_token).replace("{{username}}",Ut.getAuthenticatedUserInfo(i.id_token).username).replace("{{scope}}",t).replace("{{clientID}}",n.clientID).replace("{{clientSecret}}",null!==(r=n.clientSecret)&&void 0!==r?r:"")}))}clearUserSessionData(){return t(this,void 0,void 0,(function*(){yield this._dataLayer.removeOIDCProviderMetaData(),yield this._dataLayer.removeTemporaryData(),yield this._dataLayer.removeSessionData()}))}handleTokenResponse(e){return t(this,void 0,void 0,(function*(){if(200!==e.status)return Promise.reject(new b("AUTH_HELPER-HTR-NR01","authentication-helper","handleTokenResponse","Invalid response status received for token request.","The request sent to get the token returned "+e.status+" , which is invalid."));if((yield this._config()).validateIDToken)return this.validateIdToken(e.data.id_token).then((r=>t(this,void 0,void 0,(function*(){if(r){yield this._dataLayer.setSessionData(e.data);const t={accessToken:e.data.access_token,expiresIn:e.data.expires_in,idToken:e.data.id_token,refreshToken:e.data.refresh_token,scope:e.data.scope,tokenType:e.data.token_type};return Promise.resolve(t)}return Promise.reject(new b("AUTH_HELPER-HTR-IV02","authentication-helper","handleTokenResponse","The id token returned is not valid.","The id token returned has failed the validation check."))})))).catch((e=>Promise.reject(new b("AUTH_HELPER-HAT-ES03","authentication-helper","handleTokenResponse",void 0,void 0,e))));{const t={accessToken:e.data.access_token,expiresIn:e.data.expires_in,idToken:e.data.id_token,refreshToken:e.data.refresh_token,scope:e.data.scope,tokenType:e.data.token_type};return yield this._dataLayer.setSessionData(e.data),Promise.resolve(t)}}))}}class Ht{constructor(e){this._authenticationHelper=new Lt(e),this._dataLayer=e,this._config=()=>t(this,void 0,void 0,(function*(){return yield this._dataLayer.getConfigData()})),this._oidcProviderMetaData=()=>t(this,void 0,void 0,(function*(){return yield this._dataLayer.getOIDCProviderMetaData()}))}getAuthorizationURL(e){return t(this,void 0,void 0,(function*(){const t=yield this._dataLayer.getOIDCProviderMetaDataParameter("authorization_endpoint"),r=yield this._config();if(!t||0===t.trim().length)throw new b("AUTH_CORE-GAU-NF01","authentication-core","getAuthorizationURL","No authorization endpoint found.","No authorization endpoint was found in the OIDC provider meta data from the well-known endpoint or the authorization endpoint passed to the SDK is empty.");const n=new URL(t);n.searchParams.append("response_type","code"),n.searchParams.append("client_id",r.clientID);let i="openid";if(r.scope&&r.scope.length>0&&(r.scope.includes("openid")||r.scope.push("openid"),i=r.scope.join(" ")),n.searchParams.append("scope",i),n.searchParams.append("redirect_uri",r.signInRedirectURL),r.responseMode&&n.searchParams.append("response_mode",r.responseMode),r.enablePKCE){const e=It.getCodeVerifier(),t=It.getCodeChallenge(e);yield this._dataLayer.setTemporaryDataParameter("pkce_code_verifier",e),n.searchParams.append("code_challenge_method","S256"),n.searchParams.append("code_challenge",t)}r.prompt&&n.searchParams.append("prompt",r.prompt);const o=e;if(o)for(const[e,t]of Object.entries(o))""!=e&&""!=t&&n.searchParams.append(e,t.toString());return n.toString()}))}requestAccessToken(r,n){return t(this,void 0,void 0,(function*(){const t=(yield this._oidcProviderMetaData()).token_endpoint,i=yield this._config();if(!t||0===t.trim().length)return Promise.reject(new b("AUTH_CORE-RAT1-NF01","authentication-core","requestAccessToken","Token endpoint not found.","No token endpoint was found in the OIDC provider meta data returned by the well-known endpoint or the token endpoint passed to the SDK is empty."));n&&(yield this._dataLayer.setSessionDataParameter("session_state",n));const o=[];o.push(`client_id=${i.clientID}`),i.clientSecret&&i.clientSecret.trim().length>0&&o.push(`client_secret=${i.clientSecret}`);const s=r;return o.push(`code=${s}`),o.push("grant_type=authorization_code"),o.push(`redirect_uri=${i.signInRedirectURL}`),i.enablePKCE&&(o.push(`code_verifier=${yield this._dataLayer.getTemporaryDataParameter("pkce_code_verifier")}`),yield this._dataLayer.removeTemporaryDataParameter("pkce_code_verifier")),e.post(t,o.join("&"),{headers:Ut.getTokenRequestHeaders()}).then((e=>this._authenticationHelper.handleTokenResponse(e).then((e=>e)).catch((e=>Promise.reject(new b("AUTH_CORE-RAT1-ES02","authentication-core","requestAccessToken",void 0,void 0,e)))))).catch((e=>{var t,r,n;return Promise.reject(new A("AUTH_CORE-RAT1-NR03","authentication-core","requestAccessToken","Requesting access token failed","The request to get the access token from the server failed.",null!==(t=null==e?void 0:e.code)&&void 0!==t?t:"",null==e?void 0:e.message,null===(r=null==e?void 0:e.response)||void 0===r?void 0:r.status,null===(n=null==e?void 0:e.response)||void 0===n?void 0:n.data))}))}))}refreshAccessToken(){return t(this,void 0,void 0,(function*(){const t=(yield this._oidcProviderMetaData()).token_endpoint,r=yield this._config(),n=yield this._dataLayer.getSessionData();if(!n.refresh_token)return Promise.reject(new b("AUTH_CORE-RAT2-NF01","authentication-core","refreshAccessToken","No refresh token found.","There was no refresh token found. The identity server doesn't return a refresh token if the refresh token grant is not enabled."));if(!t||0===t.trim().length)return Promise.reject(new b("AUTH_CORE-RAT2-NF02","authentication-core","refreshAccessToken","No refresh token endpoint found.","No refresh token endpoint was in the OIDC provider meta data returned by the well-known endpoint or the refresh token endpoint passed to the SDK is empty."));const i=[];return i.push(`client_id=${r.clientID}`),i.push(`refresh_token=${n.refresh_token}`),i.push("grant_type=refresh_token"),r.clientSecret&&r.clientSecret.trim().length>0&&i.push(`client_secret=${r.clientSecret}`),e.post(t,i.join("&"),{headers:Ut.getTokenRequestHeaders()}).then((e=>this._authenticationHelper.handleTokenResponse(e).then((e=>e)).catch((e=>Promise.reject(new b("AUTH_CORE-RAT2-ES03","authentication-core","refreshAccessToken",void 0,void 0,e)))))).catch((e=>{var t,r,n;return Promise.reject(new A("AUTH_CORE-RAT2-NR03","authentication-core","refreshAccessToken","Refresh access token request failed.","The request to refresh the access token failed.",null!==(t=null==e?void 0:e.code)&&void 0!==t?t:"",null==e?void 0:e.message,null===(r=null==e?void 0:e.response)||void 0===r?void 0:r.status,null===(n=null==e?void 0:e.response)||void 0===n?void 0:n.data))}))}))}revokeAccessToken(){return t(this,void 0,void 0,(function*(){const t=(yield this._oidcProviderMetaData()).revocation_endpoint,r=yield this._config();if(!t||0===t.trim().length)return Promise.reject(new b("AUTH_CORE-RAT3-NF01","authentication-core","revokeAccessToken","No revoke access token endpoint found.","No revoke access token endpoint was found in the OIDC provider meta data returned by the well-known endpoint or the revoke access token endpoint passed to the SDK is empty."));const n=[];return n.push(`client_id=${r.clientID}`),n.push(`token=${(yield this._dataLayer.getSessionData()).access_token}`),n.push("token_type_hint=access_token"),e.post(t,n.join("&"),{headers:Ut.getTokenRequestHeaders(),withCredentials:!0}).then((e=>200!==e.status?Promise.reject(new b("AUTH_CORE-RAT3-NR02","authentication-core","revokeAccessToken","Invalid response status received for revoke access token request.","The request sent to revoke the access token returned "+e.status+" , which is invalid.")):(this._authenticationHelper.clearUserSessionData(),Promise.resolve(e)))).catch((e=>{var t,r,n;return Promise.reject(new A("AUTH_CORE-RAT3-NR03","authentication-core","revokeAccessToken","The request to revoke access token failed.","The request sent to revoke the access token failed.",null!==(t=null==e?void 0:e.code)&&void 0!==t?t:"",null==e?void 0:e.message,null===(r=null==e?void 0:e.response)||void 0===r?void 0:r.status,null===(n=null==e?void 0:e.response)||void 0===n?void 0:n.data))}))}))}requestCustomGrant(r){return t(this,void 0,void 0,(function*(){const n=yield this._oidcProviderMetaData();let i;if(i=r.tokenEndpoint&&0!==r.tokenEndpoint.trim().length?r.tokenEndpoint:n.token_endpoint,!i||0===i.trim().length)return Promise.reject(new b("AUTH_CORE-RCG-NF01","authentication-core","requestCustomGrant","Token endpoint not found.","No token endpoint was found in the OIDC provider meta data returned by the well-known endpoint or the token endpoint passed to the SDK is empty."));const o={data:(yield Promise.all(Object.entries(r.data).map((([e,r])=>t(this,void 0,void 0,(function*(){const t=yield this._authenticationHelper.replaceCustomGrantTemplateTags(r);return`${e}=${t}`})))))).join("&"),headers:Object.assign({},Ut.getTokenRequestHeaders()),method:"POST",url:i};return r.attachToken&&(o.headers=Object.assign(Object.assign({},o.headers),{Authorization:`Bearer ${(yield this._dataLayer.getSessionData()).access_token}`})),e(o).then((e=>200!==e.status?Promise.reject(new b("AUTH_CORE-RCG-NR02","authentication-core","requestCustomGrant","Invalid response status received for the custom grant request.","The request sent to get the custom grant returned "+e.status+" , which is invalid.")):r.returnsSession?this._authenticationHelper.handleTokenResponse(e).then((e=>e)).catch((e=>Promise.reject(new b("AUTH_CORE-RCG-ES03","authentication-core","requestCustomGrant",void 0,void 0,e)))):Promise.resolve(e))).catch((e=>{var t,r,n;return Promise.reject(new A("AUTH_CORE-RCG-NR04","authentication-core","requestCustomGrant","The custom grant request failed.","The request sent to get the custom grant failed.",null!==(t=null==e?void 0:e.code)&&void 0!==t?t:"",null==e?void 0:e.message,null===(r=null==e?void 0:e.response)||void 0===r?void 0:r.status,null===(n=null==e?void 0:e.response)||void 0===n?void 0:n.data))}))}))}getBasicUserInfo(){return t(this,void 0,void 0,(function*(){const e=yield this._dataLayer.getSessionData(),t=Ut.getAuthenticatedUserInfo(null==e?void 0:e.id_token);let r={allowedScopes:e.scope,sessionState:e.session_state,username:t.username};return t.displayName&&""!==t.displayName||delete t.displayName,t.tenantDomain&&""!==t.tenantDomain||delete t.tenantDomain,r=Object.assign(Object.assign({},r),t),r}))}getDecodedIDToken(){return t(this,void 0,void 0,(function*(){const e=(yield this._dataLayer.getSessionData()).id_token;return It.decodeIDToken(e)}))}getIDToken(){return t(this,void 0,void 0,(function*(){return(yield this._dataLayer.getSessionData()).id_token}))}getOIDCProviderMetaData(r){return t(this,void 0,void 0,(function*(){if(!r&&(yield this._dataLayer.getTemporaryDataParameter("op_config_initiated")))return Promise.resolve(!0);const n=yield this._authenticationHelper.resolveWellKnownEndpoint();return e.get(n).then((e=>t(this,void 0,void 0,(function*(){return 200!==e.status?Promise.reject(new b("AUTH_CORE-GOPM-NR01","authentication-core","getOIDCProviderMetaData","Invalid response status received for OIDC provider meta data request.","The request sent to the well-known endpoint to get the OIDC provider meta data returned "+e.status+" , which is invalid.")):(yield this._dataLayer.setOIDCProviderMetaData(yield this._authenticationHelper.resolveEndpoints(e.data)),yield this._dataLayer.setTemporaryDataParameter("op_config_initiated",!0),Promise.resolve(!0))})))).catch((()=>t(this,void 0,void 0,(function*(){return yield this._dataLayer.setOIDCProviderMetaData(yield this._authenticationHelper.resolveFallbackEndpoints()),yield this._dataLayer.setTemporaryDataParameter("op_config_initiated",!0),Promise.resolve(!0)}))))}))}getOIDCServiceEndpoints(){return t(this,void 0,void 0,(function*(){const e=yield this._oidcProviderMetaData();return{authorizationEndpoint:e.authorization_endpoint,checkSessionIframe:e.check_session_iframe,endSessionEndpoint:e.end_session_endpoint,introspectionEndpoint:e.introspection_endpoint,issuer:e.issuer,jwksUri:e.jwks_uri,registrationEndpoint:e.registration_endpoint,revocationEndpoint:e.revocation_endpoint,tokenEndpoint:e.token_endpoint,userinfoEndpoint:e.userinfo_endpoint,wellKnownEndpoint:yield this._authenticationHelper.resolveWellKnownEndpoint()}}))}getSignOutURL(){var e,r,n;return t(this,void 0,void 0,(function*(){const t=null===(e=yield this._oidcProviderMetaData())||void 0===e?void 0:e.end_session_endpoint,i=yield this._config();if(!t||0===t.trim().length)throw new b("AUTH_CORE-GSOU-NF01","authentication-core","getSignOutURL","Sign-out endpoint not found.","No sign-out endpoint was found in the OIDC provider meta data returned by the well-known endpoint or the sign-out endpoint passed to the SDK is empty.");const o=null===(r=yield this._dataLayer.getSessionData())||void 0===r?void 0:r.id_token;if(!o||0===o.trim().length)throw new b("AUTH_CORE-GSOU-NF02","authentication-core","getSignOutURL","ID token n0t found.","No ID token could be found. Either the session information is lost or you have not signed in.");const s=null!==(n=null==i?void 0:i.signOutRedirectURL)&&void 0!==n?n:null==i?void 0:i.signInRedirectURL;if(!s||0===s.trim().length)throw new b("AUTH_CORE-GSOU-NF03","authentication-core","getSignOutURL","No sign-out redirect URL found.","The sign-out redirect URL cannot be found or the URL passed to the SDK is empty. No sign-in redirect URL has been found either. ");return`${t}?id_token_hint=${o}&post_logout_redirect_uri=${s}&state=sign_out_success`}))}signOut(){return t(this,void 0,void 0,(function*(){const e=yield this.getSignOutURL();return this._authenticationHelper.clearUserSessionData(),e}))}getAccessToken(){var e;return t(this,void 0,void 0,(function*(){return null===(e=yield this._dataLayer.getSessionData())||void 0===e?void 0:e.access_token}))}isAuthenticated(){return t(this,void 0,void 0,(function*(){return Boolean(yield this.getAccessToken())}))}getPKCECode(){return t(this,void 0,void 0,(function*(){return yield this._dataLayer.getTemporaryDataParameter("pkce_code_verifier")}))}setPKCECode(e){return t(this,void 0,void 0,(function*(){return yield this._dataLayer.setTemporaryDataParameter("pkce_code_verifier",e)}))}updateConfig(e){return t(this,void 0,void 0,(function*(){yield this._dataLayer.setConfigData(e)}))}}class Mt{constructor(e,t){this._id=e,this._store=t}setDataInBulk(e,r){var n;return t(this,void 0,void 0,(function*(){const t=null!==(n=yield this._store.getData(e))&&void 0!==n?n:null,i=t&&JSON.parse(t),o=Object.assign(Object.assign({},i),r),s=JSON.stringify(o);yield this._store.setData(e,s)}))}setValue(e,r,n){var i;return t(this,void 0,void 0,(function*(){const t=null!==(i=yield this._store.getData(e))&&void 0!==i?i:null,o=t&&JSON.parse(t),s=Object.assign(Object.assign({},o),{[r]:n}),a=JSON.stringify(s);yield this._store.setData(e,a)}))}removeValue(e,r){var n;return t(this,void 0,void 0,(function*(){const t=null!==(n=yield this._store.getData(e))&&void 0!==n?n:null,i=t&&JSON.parse(t),o=Object.assign({},i);delete o[r];const s=JSON.stringify(o);yield this._store.setData(e,s)}))}_resolveKey(e){return`${e}-${this._id}`}setConfigData(e){return t(this,void 0,void 0,(function*(){yield this.setDataInBulk(this._resolveKey(v.ConfigData),e)}))}setOIDCProviderMetaData(e){return t(this,void 0,void 0,(function*(){this.setDataInBulk(this._resolveKey(v.OIDCProviderMetaData),e)}))}setTemporaryData(e){return t(this,void 0,void 0,(function*(){this.setDataInBulk(this._resolveKey(v.TemporaryData),e)}))}setSessionData(e){return t(this,void 0,void 0,(function*(){this.setDataInBulk(this._resolveKey(v.SessionData),e)}))}getConfigData(){var e;return t(this,void 0,void 0,(function*(){return JSON.parse(null!==(e=yield this._store.getData(this._resolveKey(v.ConfigData)))&&void 0!==e?e:null)}))}getOIDCProviderMetaData(){var e;return t(this,void 0,void 0,(function*(){return JSON.parse(null!==(e=yield this._store.getData(this._resolveKey(v.OIDCProviderMetaData)))&&void 0!==e?e:null)}))}getTemporaryData(){var e;return t(this,void 0,void 0,(function*(){return JSON.parse(null!==(e=yield this._store.getData(this._resolveKey(v.TemporaryData)))&&void 0!==e?e:null)}))}getSessionData(){var e;return t(this,void 0,void 0,(function*(){return JSON.parse(null!==(e=yield this._store.getData(this._resolveKey(v.SessionData)))&&void 0!==e?e:null)}))}removeConfigData(){return t(this,void 0,void 0,(function*(){yield this._store.removeData(this._resolveKey(v.ConfigData))}))}removeOIDCProviderMetaData(){return t(this,void 0,void 0,(function*(){yield this._store.removeData(this._resolveKey(v.OIDCProviderMetaData))}))}removeTemporaryData(){return t(this,void 0,void 0,(function*(){yield this._store.removeData(this._resolveKey(v.TemporaryData))}))}removeSessionData(){return t(this,void 0,void 0,(function*(){yield this._store.removeData(this._resolveKey(v.SessionData))}))}getConfigDataParameter(e){return t(this,void 0,void 0,(function*(){const t=yield this._store.getData(this._resolveKey(v.ConfigData));return t&&JSON.parse(t)[e]}))}getOIDCProviderMetaDataParameter(e){return t(this,void 0,void 0,(function*(){const t=yield this._store.getData(this._resolveKey(v.OIDCProviderMetaData));return t&&JSON.parse(t)[e]}))}getTemporaryDataParameter(e){return t(this,void 0,void 0,(function*(){const t=yield this._store.getData(this._resolveKey(v.TemporaryData));return t&&JSON.parse(t)[e]}))}getSessionDataParameter(e){return t(this,void 0,void 0,(function*(){const t=yield this._store.getData(this._resolveKey(v.SessionData));return t&&JSON.parse(t)[e]}))}setConfigDataParameter(e,r){return t(this,void 0,void 0,(function*(){yield this.setValue(this._resolveKey(v.ConfigData),e,r)}))}setOIDCProviderMetaDataParameter(e,r){return t(this,void 0,void 0,(function*(){yield this.setValue(this._resolveKey(v.OIDCProviderMetaData),e,r)}))}setTemporaryDataParameter(e,r){return t(this,void 0,void 0,(function*(){yield this.setValue(this._resolveKey(v.TemporaryData),e,r)}))}setSessionDataParameter(e,r){return t(this,void 0,void 0,(function*(){yield this.setValue(this._resolveKey(v.SessionData),e,r)}))}removeConfigDataParameter(e){return t(this,void 0,void 0,(function*(){yield this.removeValue(this._resolveKey(v.ConfigData),e)}))}removeOIDCProviderMetaDataParameter(e){return t(this,void 0,void 0,(function*(){yield this.removeValue(this._resolveKey(v.OIDCProviderMetaData),e)}))}removeTemporaryDataParameter(e){return t(this,void 0,void 0,(function*(){yield this.removeValue(this._resolveKey(v.TemporaryData),e)}))}removeSessionDataParameter(e){return t(this,void 0,void 0,(function*(){yield this.removeValue(this._resolveKey(v.SessionData),e)}))}}const jt={clientHost:origin,clockTolerance:300,enablePKCE:!0,responseMode:r.query,scope:["openid"],validateIDToken:!0};class Kt{
/**
     * This is the constructor method that returns an instance of the .
     *
     * @param {Store} store - The store object.
     *
     * @example
     * ```
     * const _store: Store = new DataStore();
     * const auth = new AsgardeoAuthClient<CustomClientConfig>(_store);
     * ```
     *
     * @link https://github.com/asgardeo/asgardeo-auth-js-sdk/tree/master#constructor
     * @preserve
     */
constructor(e){Kt._instanceID?Kt._instanceID+=1:Kt._instanceID=0,this._dataLayer=new Mt(`instance_${Kt._instanceID}`,e),this._authenticationCore=new Ht(this._dataLayer)}
/**
     *
     * This method initializes the SDK with the config data.
     *
     * @param {AuthClientConfig<T>} config - The config object to initialize with.
     *
     * @example
     * const config = {
     *     signInRedirectURL: "http://localhost:3000/sign-in",
     *     clientID: "client ID",
     *     serverOrigin: "https://localhost:9443"
     * }
     *
     * await auth.initialize(config);
     *
     * @link https://github.com/asgardeo/asgardeo-auth-js-sdk/tree/master#initialize
     *
     * @preserve
     */initialize(e){return t(this,void 0,void 0,(function*(){yield this._dataLayer.setConfigData(Object.assign(Object.assign({},jt),e))}))}
/**
     * This method returns the `DataLayer` object that allows you to access authentication data.
     *
     * @return {DataLayer} - The `DataLayer` object.
     *
     * @example
     * ```
     * const data = auth.getDataLayer();
     * ```
     *
     * @link https://github.com/asgardeo/asgardeo-auth-js-sdk/tree/master#getDataLayer
     *
     * @memberof AsgardeoAuthClient
     *
     * @preserve
     */getDataLayer(){return this._dataLayer}
/**
     * This is an async method that returns a Promise that resolves with the authorization URL.
     *
     * @param {GetAuthURLConfig} config - (Optional) A config object to force initialization and pass
     * custom path parameters such as the fidp parameter.
     *
     * @return {Promise<string>} - A promise that resolves with the authorization URL.
     *
     * @example
     * ```
     * auth.getAuthorizationURL().then((url)=>{
     *  // console.log(url);
     * }).catch((error)=>{
     *  // console.error(error);
     * });
     * ```
     *
     * @link https://github.com/asgardeo/asgardeo-auth-js-sdk/tree/master#getAuthorizationURL
     *
     * @memberof AsgardeoAuthClient
     *
     * @preserve
     */getAuthorizationURL(e){return t(this,void 0,void 0,(function*(){const t=Object.assign({},e);return null==t||delete t.forceInit,(yield this._dataLayer.getTemporaryDataParameter("op_config_initiated"))?this._authenticationCore.getAuthorizationURL(t):this._authenticationCore.getOIDCProviderMetaData(null==e?void 0:e.forceInit).then((()=>this._authenticationCore.getAuthorizationURL(t)))}))}
/**
     * This is an async method that sends a request to obtain the access token and returns a Promise
     * that resolves with the token and other relevant data.
     *
     * @param {string} authorizationCode - The authorization code.
     * @param {string} sessionState - The session state.
     *
     * @return {Promise<TokenResponse>} - A Promise that resolves with the token response.
     *
     * @example
     * ```
     * auth.requestAccessToken(authCode, sessionState).then((token)=>{
     *  // console.log(token);
     * }).catch((error)=>{
     *  // console.error(error);
     * });
     * ```
     *
     * @link https://github.com/asgardeo/asgardeo-auth-js-sdk/tree/master#requestAccessToken
     *
     * @memberof AsgardeoAuthClient
     *
     * @preserve
     */requestAccessToken(e,r){return t(this,void 0,void 0,(function*(){return(yield this._dataLayer.getTemporaryDataParameter("op_config_initiated"))?this._authenticationCore.requestAccessToken(e,r):this._authenticationCore.getOIDCProviderMetaData(!1).then((()=>this._authenticationCore.requestAccessToken(e,r)))}))}
/**
     * This method clears all authentication data and returns the sign-out URL.
     *
     * @return {Promise<string>} - A Promise that resolves with the sign-out URL.
     *
     * @example
     * ```
     * const signOutUrl = await auth.signOut();
     * ```
     *
     * @link https://github.com/asgardeo/asgardeo-auth-js-sdk/tree/master#signOut
     *
     * @memberof AsgardeoAuthClient
     *
     * @preserve
     */signOut(){return t(this,void 0,void 0,(function*(){return this._authenticationCore.signOut()}))}
/**
     * This method returns the sign-out URL.
     *
     * **This doesn't clear the authentication data.**
     *
     * @return {Promise<string>} - A Promise that resolves with the sign-out URL.
     *
     * @example
     * ```
     * const signOutUrl = await auth.getSignOutURL();
     * ```
     *
     * @link https://github.com/asgardeo/asgardeo-auth-js-sdk/tree/master#getSignOutURL
     *
     * @memberof AsgardeoAuthClient
     *
     * @preserve
     */getSignOutURL(){return t(this,void 0,void 0,(function*(){return this._authenticationCore.getSignOutURL()}))}
/**
     * This method returns OIDC service endpoints that are fetched from the `.well-known` endpoint.
     *
     * @return {Promise<OIDCEndpoints>} - A Promise that resolves with an object containing the OIDC service endpoints.
     *
     * @example
     * ```
     * const endpoints = await auth.getOIDCServiceEndpoints();
     * ```
     *
     * @link https://github.com/asgardeo/asgardeo-auth-js-sdk/tree/master#getOIDCServiceEndpoints
     *
     * @memberof AsgardeoAuthClient
     *
     * @preserve
     */getOIDCServiceEndpoints(){return t(this,void 0,void 0,(function*(){return this._authenticationCore.getOIDCServiceEndpoints()}))}
/**
     * This method decodes the payload of the ID token and returns it.
     *
     * @return {Promise<DecodedIDTokenPayload>} - A Promise that resolves with the decoded ID token payload.
     *
     * @example
     * ```
     * const decodedIdToken = await auth.getDecodedIDToken();
     * ```
     *
     * @link https://github.com/asgardeo/asgardeo-auth-js-sdk/tree/master#getDecodedIDToken
     *
     * @memberof AsgardeoAuthClient
     *
     * @preserve
     */getDecodedIDToken(){return t(this,void 0,void 0,(function*(){return this._authenticationCore.getDecodedIDToken()}))}
/**
     * This method returns the ID token.
     *
     * @return {Promise<string>} - A Promise that resolves with the ID token.
     *
     * @example
     * ```
     * const idToken = await auth.getIDToken();
     * ```
     *
     * @link https://github.com/asgardeo/asgardeo-auth-js-sdk/tree/master#getIDToken
     *
     * @memberof AsgardeoAuthClient
     *
     * @preserve
     */getIDToken(){return t(this,void 0,void 0,(function*(){return this._authenticationCore.getIDToken()}))}
/**
     * This method returns the basic user information obtained from the ID token.
     *
     * @return {Promise<BasicUserInfo>} - A Promise that resolves with an object containing the basic user information.
     *
     * @example
     * ```
     * const userInfo = await auth.getBasicUserInfo();
     * ```
     *
     * @link https://github.com/asgardeo/asgardeo-auth-js-sdk/tree/master#getBasicUserInfo
     *
     * @memberof AsgardeoAuthClient
     *
     * @preserve
     */getBasicUserInfo(){return t(this,void 0,void 0,(function*(){return this._authenticationCore.getBasicUserInfo()}))}
/**
     * This method revokes the access token.
     *
     * **This method also clears the authentication data.**
     *
     * @return {Promise<AxiosResponse>} - A Promise that returns the response of the revoke-access-token request.
     *
     * @example
     * ```
     * auth.revokeAccessToken().then((response)=>{
     *  // console.log(response);
     * }).catch((error)=>{
     *  // console.error(error);
     * });
     * ```
     *
     * @link https://github.com/asgardeo/asgardeo-auth-js-sdk/tree/master#revokeAccessToken
     *
     * @memberof AsgardeoAuthClient
     *
     * @preserve
     */revokeAccessToken(){return this._authenticationCore.revokeAccessToken()}
/**
     * This method refreshes the access token and returns a Promise that resolves with the new access
     * token and other relevant data.
     *
     * @return {Promise<TokenResponse>} - A Promise that resolves with the token response.
     *
     * @example
     * ```
     * auth.refreshAccessToken().then((response)=>{
     *  // console.log(response);
     * }).catch((error)=>{
     *  // console.error(error);
     * });
     * ```
     *
     * @link https://github.com/asgardeo/asgardeo-auth-js-sdk/tree/master#refreshAccessToken
     *
     * @memberof AsgardeoAuthClient
     *
     * @preserve
     */refreshAccessToken(){return this._authenticationCore.refreshAccessToken()}
/**
     * This method returns the access token.
     *
     * @return {Promise<string>} - A Promise that resolves with the access token.
     *
     * @example
     * ```
     * const accessToken = await auth.getAccessToken();
     * ```
     *
     * @link https://github.com/asgardeo/asgardeo-auth-js-sdk/tree/master#getAccessToken
     *
     * @memberof AsgardeoAuthClient
     *
     * @preserve
     */getAccessToken(){return t(this,void 0,void 0,(function*(){return this._authenticationCore.getAccessToken()}))}
/**
     * This method sends a custom-grant request and returns a Promise that resolves with the response
     * depending on the config passed.
     *
     * @param {CustomGrantConfig} config - A config object containing the custom grant configurations.
     *
     * @return {Promise<TokenResponse | AxiosResponse>} - A Promise that resolves with the response depending
     * on your configurations.
     *
     * @example
     * ```
     * const config = {
     *   attachToken: false,
     *   data: {
     *       client_id: "{{clientID}}",
     *       grant_type: "account_switch",
     *       scope: "{{scope}}",
     *       token: "{{token}}",
     *   },
     *   id: "account-switch",
     *   returnResponse: true,
     *   returnsSession: true,
     *   signInRequired: true
     * }
     *
     * auth.requestCustomGrant(config).then((response)=>{
     *  // console.log(response);
     * }).catch((error)=>{
     *  // console.error(error);
     * });
     * ```
     *
     * @link https://github.com/asgardeo/asgardeo-auth-js-sdk/tree/master#requestCustomGrant
     *
     * @memberof AsgardeoAuthClient
     *
     * @preserve
     */requestCustomGrant(e){return this._authenticationCore.requestCustomGrant(e)}
/**
     * This method returns if the user is authenticated or not.
     *
     * @return {Promise<boolean>} - A Promise that resolves with `true` if the user is authenticated, `false` otherwise.
     *
     * @example
     * ```
     * await auth.isAuthenticated();
     * ```
     *
     * @link https://github.com/asgardeo/asgardeo-auth-js-sdk/tree/master#isAuthenticated
     *
     * @memberof AsgardeoAuthClient
     *
     * @preserve
     */isAuthenticated(){return t(this,void 0,void 0,(function*(){return this._authenticationCore.isAuthenticated()}))}
/**
     * This method returns the PKCE code generated during the generation of the authentication URL.
     *
     * @return {Promise<string>} - A Promise that resolves with the PKCE code.
     *
     * @example
     * ```
     * const pkce = await getPKCECode();
     * ```
     *
     * @link https://github.com/asgardeo/asgardeo-auth-js-sdk/tree/master#getPKCECode
     *
     * @memberof AsgardeoAuthClient
     *
     * @preserve
     */getPKCECode(){return t(this,void 0,void 0,(function*(){return this._authenticationCore.getPKCECode()}))}
/**
     * This method sets the PKCE code to the data store.
     *
     * @param {string} pkce - The PKCE code.
     *
     * @example
     * ```
     * await auth.setPKCECode("pkce_code")
     * ```
     *
     * @link https://github.com/asgardeo/asgardeo-auth-js-sdk/tree/master#setPKCECode
     *
     * @memberof AsgardeoAuthClient
     *
     * @preserve
     */setPKCECode(e){return t(this,void 0,void 0,(function*(){yield this._authenticationCore.setPKCECode(e)}))}
/**
     * This method returns if the sign-out is successful or not.
     *
     * @param {string} signOutRedirectUrl - The URL to which the user has been redirected to after signing-out.
     *
     * **The server appends path parameters to the `signOutRedirectURL` and these path parameters
     *  are required for this method to function.**
     *
     * @return {boolean} - `true` if successful, `false` otherwise.
     *
     * @link https://github.com/asgardeo/asgardeo-auth-js-sdk/tree/master#isSignOutSuccessful
     *
     * @memberof AsgardeoAuthClient
     *
     * @preserve
     */static isSignOutSuccessful(e){const t=new URL(e),r=t.searchParams.get("state"),n=Boolean(t.searchParams.get("error"));return!!r&&("sign_out_success"===r&&!n)}
/**
     * This method updates the configuration that was passed into the constructor when instantiating this class.
     *
     * @param {Partial<AuthClientConfig<T>>} config - A config object to update the SDK configurations with.
     *
     * @example
     * ```
     * const config = {
     *     signInRedirectURL: "http://localhost:3000/sign-in",
     *     clientID: "client ID",
     *     serverOrigin: "https://localhost:9443"
     * }
     *
     * await auth.updateConfig(config);
     * ```
     * @link https://github.com/asgardeo/asgardeo-auth-js-sdk/tree/master#updateConfig
     *
     * @memberof AsgardeoAuthClient
     *
     * @preserve
     */updateConfig(e){this._authenticationCore.updateConfig(e)}}export{m as AUTHORIZATION_CODE,Kt as AsgardeoAuthClient,f as CLIENT_ID_TAG,p as CLIENT_SECRET_TAG,S as OIDC_SCOPE,y as PKCE_CODE_VERIFIER,g as REFRESH_TOKEN_TIMER,r as ResponseMode,l as SCOPE_TAG,w as SESSION_STATE,T as SIGN_OUT_SUCCESS_PARAM,_ as SIGN_OUT_URL,v as Stores,h as TOKEN_TAG,d as USERNAME_TAG};
//# sourceMappingURL=asgardeo-auth.production.esm.js.map
